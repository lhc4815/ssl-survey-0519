<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>SSL í•™ì—…ìˆœí™˜êµ¬ì¡°(ì‘ë‹µìš©)</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100vw; height: 100vh;
      display: flex; align-items: center; justify-content: center;
      background: #E3EAF5; font-family: Arial, sans-serif;
    }
    #container {
      box-sizing: border-box;
      width: 90vw; max-width: 900px; max-height: 90vh;
      overflow-y: auto; padding: 24px;
      background: rgba(255,255,255,0.85);
      backdrop-filter: blur(10px); border-radius: 8px;
    }
    h2 {
      margin-top: 0; font-size: 1.6em;
      border-bottom: 2px solid #DDD; padding-bottom: 8px;
      color: #1A237E;
    }
    .filter-row {
      display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 16px;
    }
    .filter-row input,
    .filter-row select {
      flex: 1; min-width: 150px;
      padding: 8px 12px; font-size: 1em;
      border: 1px solid #AAA; border-radius: 4px; background: #FFF;
    }
    .filter-group { margin-bottom: 16px; }
    .filter-group span {
      font-weight: bold; margin-right: 8px; color: #1A237E;
    }
    .pill {
      display: inline-block; margin: 4px 6px 4px 0;
      padding: 6px 14px; border: 1px solid #AAA;
      border-radius: 16px; background: #FFF; cursor: pointer;
      transition: .2s; user-select: none;
    }
    .pill.selected {
      background: #C5CAE9; color: #1A237E; border-color: #3F51B5;
    }
    #start {
      display: block; margin: 24px auto 0;
      padding: 12px 32px; font-size: 1.1em;
      background: #5C6BC0; color: #fff;
      border: none; border-radius: 4px; cursor: pointer;
      transition: .2s;
    }
    #start:disabled {
      background: #D1C4E9; cursor: not-allowed;
    }
    #start:not(:disabled):hover {
      background: #8291ea;
    }
    .hidden { display: none; }

    /* â€” ì´í•˜ ì„¤ë¬¸Â·ê²°ê³¼ í™”ë©´ ìŠ¤íƒ€ì¼ â€” */
    .timer-segment {
      margin-bottom: 12px; font-size: 1em; color: #555;
    }
    #personal-info {
      font-size: 0.8em; color: #2b196d;
      margin-bottom: 12px; padding: 12px;
      background: #ccd1eb; border: 1px solid #9092dc;
      border-radius: 4px;
    }
    .question {
      font-size: 1.4em; color: #1A237E; margin-bottom: 20px;
    }
    #total-timer, #segment-timer, #timer, #progress {
      font-size: 1em; color: #eb8181; margin-bottom: 10px;
    }
    .answers {
      display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 10px;
    }
    .answers button {
      flex: 1; min-width: 120px; padding: 16px; font-size: 1.2em;
      border: 1px solid #888; border-radius: 4px; background: #FFF;
      transition: .2s;
    }
    .answers button:hover {
      background: #E8EAF6; border-color: #000000;
    }
    .answers button.selected {
      background: #3F51B5; color: #fff; border-color: #160e67;
    }
    #hint {
      font-size: 0.9em; color: #555; margin-bottom: 20px;
      text-align: center;
    }
    #survey nav {
      display: flex; gap: 10px; margin-top: 10px;
    }
    #survey nav #prev { display: none; }
    #survey nav button {
      flex: 1; padding: 12px 20px; font-size: 1.2em;
      background: #C5CAE9; border: none;
      border-radius: 4px; color: #1A237E; transition: .2s;
    }
    #survey nav button:disabled {
      background: #D1C4E9; cursor: not-allowed;
    }
    #survey nav button:not(:disabled):hover {
      background: #303F9F;
    }
    #download-link {
      display: inline-block; margin-top: 20px; padding: 10px 20px;
      background: #3949AB; color: #fff;
      text-decoration: none; border-radius: 4px; transition: .2s;
    }
    #download-link:hover { background: #303F9F; }

     /* ë””ë²„ê·¸ ë²„íŠ¼ ê³ ì • ìœ„ì¹˜ */
    #dev-buttons {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
    }
    #dev-buttons button {
      margin-left: 6px;
      padding: 6px 12px;
      font-size: 0.9em;
      border: none;
      background: #FF8F00;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }
    #dev-buttons button:hover {
      background: #E65100;
    }
    
  </style>

  <!-- ì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸ -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="script.js" defer></script>
</head>

<body>
  <!-- ë””ë²„ê·¸ìš©: ìµœìƒë‹¨ ê³ ì • ë²„íŠ¼ -->
  <!-- <div id="dev-buttons">
    <button id="dev-b">â–¶ Type Bë¡œ ë°”ë¡œ ì´ë™</button>
    <button id="dev-c">â–¶ Type Cë¡œ ë°”ë¡œ ì´ë™</button>
    <button id="dev-finish">â–¶ ì„¤ë¬¸ ì™„ë£Œë¡œ ì´ë™</button>
  </div>-->

  <div id="container">
    <!-- â–  7ìë¦¬ ì½”ë“œ ì…ë ¥ í¼: í˜ì´ì§€ ì§„ì… ì „ ì½”ë“œ ê²€ì¦ìš© -->
    <div id="code-form">
      <div style="text-align: center;">
      <h2><strong>ğŸ“¥ ì‚¬ì „ì— ì•ˆë‚´ ë°›ì€ 7ìë¦¬ ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!</strong></h2>
      <!-- 7ìë¦¬ ì½”ë“œ ì…ë ¥ í•„ë“œ -->
      <input type="text" id="stu-code" maxlength="7" placeholder="7ìë¦¬ ì½”ë“œ" />
      <!-- ê²€ì¦ ë²„íŠ¼ -->
      <button id="code-submit" type="button">í™•ì¸</button>
     
      <div id="code-message" style="color:red; margin-top:8px;"></div>
      </div>
    </div>

    <!-- 1) ê°œì¸ì •ë³´ ì…ë ¥ -->
    <div id="user-form" class="hidden">
      <div style="font-size:1.1em; background:#FFFDE7; padding:16px; border-left:6px solid #FBC02D; margin-bottom:16px; color:#5D4037;">
        ğŸ“‹ ë³¸ ì„¤ë¬¸ì€ ì´ 3ë‹¨ê³„ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ìµœëŒ€ ì†Œìš” ì‹œê°„ì€ <strong>90ë¶„</strong>ì…ë‹ˆë‹¤.<br><br>
        1ï¸âƒ£ <strong>Type A</strong>: ì„±í–¥ ê²€ì‚¬ â€“ ì´ 240ë¬¸í•­, ì•½ 40ë¶„<br>
        2ï¸âƒ£ <strong>Type B</strong>: ì˜ì–´ ì´í•´ë ¥ â€“ ì´ 10ë¬¸í•­, ì•½ 10ë¶„<br>
        3ï¸âƒ£ <strong>Type C</strong>: ìˆ˜í•™ ë¬¸ì œ í•´ê²°ë ¥ â€“ ì´ 10ë¬¸í•­, ì•½ 40ë¶„<br><br>
        ëª¨ë“  ë‹¨ê³„ëŠ” ì„¤ë¬¸ ì‹œì‘ í›„ ìë™ìœ¼ë¡œ ì´ì–´ì§‘ë‹ˆë‹¤. ì„±ì‹¤í•œ ì‘ë‹µ ë¶€íƒë“œë¦½ë‹ˆë‹¤.
      </div>

      <h2>ì •ë³´ ì…ë ¥</h2>
      <div class="filter-row">
        <input type="text" id="name" placeholder="1. í•™ìƒ ì„±ëª…" />
        <input type="text" id="school" placeholder="2. ì¶œì‹  í•™êµ" />
        <select id="gender">
          <option value="" disabled selected>3. ì„±ë³„</option>
          <option value="ë‚¨">ë‚¨ì„±</option>
          <option value="ì—¬">ì—¬ì„±</option>
          <option value="ê¸°íƒ€">ê¸°íƒ€</option>
        </select>
      </div>

      <div class="filter-row">
        <select id="region">
          <option value="" disabled selected>4. ê±°ì£¼ì§€ì—­</option>
          <option value="ê°•ì›ë„">ê°•ì›ë„</option>
          <option value="ê´‘ì£¼ ê´‘ì—­ì‹œ">ê´‘ì£¼ ê´‘ì—­ì‹œ</option>
          <option value="ê²½ê¸°ë„">ê²½ê¸°ë„</option>
          <option value="ê²½ìƒë‚¨ë„">ê²½ìƒë‚¨ë„</option>
          <option value="ê²½ìƒë¶ë„">ê²½ìƒë¶ë„</option>
          <option value="ëŒ€êµ¬ ê´‘ì—­ì‹œ">ëŒ€êµ¬ ê´‘ì—­ì‹œ</option>
          <option value="ëŒ€ì „ ê´‘ì—­ì‹œ">ëŒ€ì „ ê´‘ì—­ì‹œ</option>
          <option value="ë¶€ì‚° ê´‘ì—­ì‹œ">ë¶€ì‚° ê´‘ì—­ì‹œ</option>
          <option value="ì„œìš¸ íŠ¹ë³„ì‹œ">ì„œìš¸ íŠ¹ë³„ì‹œ</option>
          <option value="ì„¸ì¢… íŠ¹ë³„ìì¹˜ì‹œ">ì„¸ì¢… íŠ¹ë³„ìì¹˜ì‹œ</option>
          <option value="ìš¸ì‚° ê´‘ì—­ì‹œ">ìš¸ì‚° ê´‘ì—­ì‹œ</option>
          <option value="ì¸ì²œ ê´‘ì—­ì‹œ">ì¸ì²œ ê´‘ì—­ì‹œ</option>
          <option value="ì „ë¼ë‚¨ë„">ì „ë¼ë‚¨ë„</option>
          <option value="ì „ë¼ë¶ë„">ì „ë¼ë¶ë„</option>
          <option value="ì œì£¼ íŠ¹ë³„ìì¹˜ë„">ì œì£¼ íŠ¹ë³„ìì¹˜ë„</option>
          <option value="ì¶©ì²­ë‚¨ë„">ì¶©ì²­ë‚¨ë„</option>
          <option value="ì¶©ì²­ë¶ë„">ì¶©ì²­ë¶ë„</option>
        </select>
      </div>

      <div class="filter-group hidden" id="subregion-group">
        <span>4-1. ì„œìš¸ ë‚´ ê¶Œì—­ ì„ íƒ</span>
        <div class="pill" data-value="ê°•ë‚¨">ê°•ë‚¨</div>
        <div class="pill" data-value="ì„œì´ˆ">ì„œì´ˆ</div>
        <div class="pill" data-value="ì†¡íŒŒ">ì†¡íŒŒ</div>
        <div class="pill" data-value="ëª©ë™">ëª©ë™</div>
        <div class="pill" data-value="ì¤‘ê³„">ì¤‘ê³„</div>
        <div class="pill" data-value="ê¸°íƒ€ ì§€ì—­">ê¸°íƒ€ ì§€ì—­</div>
      </div>

      <div class="filter-group hidden" id="middleschool-group">
        <span>4-2. ì¶œì‹  ì¤‘í•™êµ ì„ íƒ</span>
        <select id="middleschool">
          <option value="" disabled selected>ì¤‘í•™êµ ì„ íƒ</option>
        </select>
      </div>

      <div class="filter-group" id="bcount-group">
        <span>5. Bë“±ê¸‰ ê³¼ëª© ìˆ˜</span>
        <div class="pill" data-value="0ê°œ">0ê°œ</div>
        <div class="pill" data-value="1ê°œ">1ê°œ</div>
        <div class="pill" data-value="2ê°œ~3ê°œ">2ê°œ~3ê°œ</div>
        <div class="pill" data-value="5ê°œ ì´í•˜">5ê°œ ì´í•˜</div>
        <div class="pill" data-value="5ê°œ ì´ˆê³¼">5ê°œ ì´ˆê³¼</div>
      </div>

      <div class="filter-group" id="schooltype-group">
        <span>6. ì§„í•™ ì§€ë§ ê³ êµ ë¶„ë¥˜</span>
        <div class="pill" data-value="ì „êµ­ë‹¨ìœ„ìì‚¬ê³ ">ì „êµ­ë‹¨ìœ„ìì‚¬ê³ </div>
        <div class="pill" data-value="ì§€ì—­ìì‚¬ê³ ">ì§€ì—­ìì‚¬ê³ </div>
        <div class="pill" data-value="ì™¸ê³ ">ì™¸ê³ </div>
        <div class="pill" data-value="êµ­ì œê³ ">êµ­ì œê³ </div>
        <div class="pill" data-value="ì„œìš¸í˜• ìì‚¬ê³ ">ì„œìš¸í˜• ìì‚¬ê³ </div>
        <div class="pill" data-value="ì¼ë°˜ê³ ">ì¼ë°˜ê³ </div>
      </div>

      <div class="filter-group" style="margin-top: 20px; text-align: center;">
        <label style="display: inline-flex; align-items: center; cursor: pointer; background: #FFF3E0; padding: 6px 12px; border-radius: 4px; border: 1px solid #FFB74D;">
          <input type="checkbox" id="test-mode" style="margin-right: 8px;">
          <span style="color: #E64A19; font-weight: bold;">í…ŒìŠ¤íŠ¸ ëª¨ë“œ í™œì„±í™” (ë§ˆì§€ë§‰ ë¬¸í•­ìœ¼ë¡œ ë°”ë¡œ ì´ë™)</span>
        </label>
      </div>
      
      <script>
        // í…ŒìŠ¤íŠ¸ ëª¨ë“œ DOM ë¡œë”© í™•ì¸
        document.addEventListener('DOMContentLoaded', function() {
          console.log('í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì²´í¬ë°•ìŠ¤ ë¡œë”© í™•ì¸:', document.getElementById('test-mode'));
        });
      </script>

      <button id="start" disabled>ì„¤ë¬¸ ì‹œì‘</button>
    </div>

    <!-- 2) ì„¤ë¬¸ ì§„í–‰ í™”ë©´ -->
    <div id="survey" class="hidden">
      <h2>ì„¤ë¬¸ ì§„í–‰</h2>
      <div class="timer-segment">â€¢ ì „ì²´ ì œí•œ ì‹œê°„: 90ë¶„</div>
      <div class="timer-segment">â€¢ Type A: 240ë¬¸í•­ â†’ 40ë¶„ (10ì´ˆ/ë¬¸í•­)</div>
      <div class="timer-segment">â€¢ Type B: 10ë¬¸í•­ â†’ 10ë¶„ (60ì´ˆ/ë¬¸í•­)</div>
      <div class="timer-segment">â€¢ Type C: 10ë¬¸í•­ â†’ 40ë¶„ (4ë¶„/ë¬¸í•­)</div>

      <div id="personal-info"></div>
      <div class="question" id="question-text"></div>
      <div id="total-timer"></div>
      <div id="segment-timer"></div>
      <div id="timer"></div>
      <div id="progress">
        <span id="questionProgress">0/0</span>
      </div>
      
      <div class="answers" id="answers"></div>

      <nav>
        <button id="prev">â—€ ì´ì „</button>
        <button id="next" disabled>ë‹¤ìŒ â–¶</button>
      </nav>
    </div>

  <!-- 3) ê²°ê³¼ í™”ë©´ -->
      <!-- 3) ê²°ê³¼ í™”ë©´ -->
  <div id="result" class="hidden">
    <h2>ì„¤ë¬¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤!</h2>
    <div style="padding: 20px; background-color: #f5f5f5; border-radius: 8px; text-align: center; margin: 20px 0;">
      <p style="font-size: 1.1em; margin-bottom: 15px;">ğŸ“§ ì„¤ë¬¸ ê²°ê³¼ê°€ ê´€ë¦¬ìì—ê²Œ ì´ë©”ì¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤.</p>
      <p style="color: #555;">ì´ë©”ì¼ ì „ì†¡ ì¤‘... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.</p>
    </div>
    <!-- ì•„ë˜ ë§í¬ëŠ” ë²„ì „ í˜¸í™˜ì„±ì„ ìœ„í•´ ë‚¨ê²¨ë‘ì§€ë§Œ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ìˆ¨ê¹€ ì²˜ë¦¬ë©ë‹ˆë‹¤ -->
    <a id="download-link" href="#" download="survey_result.xlsx" style="display:none;">
      ğŸ“¥ ìµœê·¼ ì„¤ë¬¸ ë‹¤ìš´ë¡œë“œ
    </a>
    <a id="used-download-link" href="#" download="used_stu_codes.xlsx" style="display:none;">
      ğŸ“¥ ì‚¬ìš©ëœ ì½”ë“œ ë‹¤ìš´ë¡œë“œ
    </a>
  </div>

  </div>

  <!-- inline ìŠ¤í¬ë¦½íŠ¸: 4ë²ˆ ë™ì  ì²˜ë¦¬ & start ë²„íŠ¼ í™œì„±í™” -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const regionIn   = document.getElementById('region');
    const subRgGrp   = document.getElementById('subregion-group');
    const msGrp      = document.getElementById('middleschool-group');
    const msSelect   = document.getElementById('middleschool');
    const schoolIn   = document.getElementById('school');
    const subPills   = document.querySelectorAll('#subregion-group .pill');
    const nameIn     = document.getElementById('name');
    const genderIn   = document.getElementById('gender');
    const bPills     = document.querySelectorAll('#bcount-group .pill');
    const tPills     = document.querySelectorAll('#schooltype-group .pill');
    const startBtn   = document.getElementById('start');

    // ì…ë ¥ ì™„ì„± ì‹œë§Œ í™œì„±í™”
    function validate() {
      const nameOK   = !!nameIn.value.trim();
      const genderOK = !!genderIn.value;
      const regionOK = !!regionIn.value;
      let schoolOK  = false;
      if(regionIn.value === 'ì„œìš¸ íŠ¹ë³„ì‹œ') {
        const sel = [...subPills].find(p=>p.classList.contains('selected'));
        if(sel) {
          if(sel.dataset.value === 'ê¸°íƒ€ ì§€ì—­') schoolOK = !!schoolIn.value.trim();
          else schoolOK = !!msSelect.value;
        }
      } else {
        schoolOK = !!schoolIn.value.trim();
      }
      const bOK = [...bPills].some(p=>p.classList.contains('selected'));
      const tOK = [...tPills].some(p=>p.classList.contains('selected'));
      startBtn.disabled = !(nameOK && genderOK && regionOK && schoolOK && bOK && tOK);
    }

    // 4ë²ˆ: ê±°ì£¼ì§€ì—­ ë³€ê²½
  function regionChange() {
    if (regionIn.value === 'ì„œìš¸ íŠ¹ë³„ì‹œ') {
      // ì„œìš¸ â†’ êµ¬ ì„ íƒì„ ìœ„í•´ í˜ë„ë§Œ ì—´ê³ , ë‘˜ ë‹¤ ìˆ¨ê¹€
      subRgGrp.classList.remove('hidden');
      msGrp.classList.add('hidden');
      schoolIn.classList.remove('hidden');
      msSelect.innerHTML = '<option value="" disabled selected>ì¤‘í•™êµ ì„ íƒ</option>';
    } else {
      // ê¸°íƒ€ ì§€ì—­ â†’ ëª¨ë“  ì„œìš¸ ê´€ë ¨ UI ìˆ¨ê¸°ê³ , í…ìŠ¤íŠ¸ë°•ìŠ¤ë§Œ í‘œì‹œ
      subRgGrp.classList.add('hidden');
      msGrp.classList.add('hidden');
      msSelect.innerHTML = '<option value="" disabled selected>ì¤‘í•™êµ ì„ íƒ</option>';
      schoolIn.classList.remove('hidden');
    }
    validate();
  }
    regionIn.addEventListener('change', regionChange);
    regionIn.addEventListener('input', regionChange);

    const schoolMap = {
      'ê°•ë‚¨': ['ë‹¨ëŒ€ë¶€ì¤‘', 'ì—­ì‚¼ì¤‘', 'ë„ê³¡ì¤‘', 'ëŒ€ëª…ì¤‘', 'ëŒ€ì²­ì¤‘', 'ìˆ™ëª…ì—¬ì¤‘', 'íœ˜ë¬¸ì¤‘'],
      'ì„œì´ˆ': ['ì›ì´Œì¤‘','ì„œì´ˆì¤‘','ë°˜í¬ì¤‘', 'ì„¸í™”ì—¬ì¤‘'],
      'ì†¡íŒŒ': ['ì ì‹¤ì¤‘','ì†¡ë¡€ì¤‘','í’ë‚©ì¤‘'],
      'ëª©ë™': ['ëª©ë™ì¤‘','ëª©ì¼ì¤‘','ì‹ ëª©ì¤‘', 'ì›”ì´Œì¤‘', 'ì–‘ì •ì¤‘', 'ëª©ìš´ì¤‘'],
      'ì¤‘ê³„': ['ì¤‘ê³„ì¤‘','ìƒëª…ì¤‘','ë¶ˆì•”ì¤‘', 'ì„ì§€ì¤‘']
    };

    // 4-1ë²ˆ: ê¶Œì—­ í´ë¦­
subPills.forEach(p => p.addEventListener('click', () => {
  // (1) ë¹„ì£¼ì–¼ í† ê¸€
  subPills.forEach(x => x.classList.remove('selected'));
  p.classList.add('selected');

  const v = p.dataset.value;
  if (v === 'ê¸°íƒ€ ì§€ì—­') {
    // í…ìŠ¤íŠ¸ ì…ë ¥ë§Œ
    msGrp.classList.add('hidden');
    schoolIn.classList.remove('hidden');
    msSelect.innerHTML = '<option value="" disabled selected>ì¤‘í•™êµ ì„ íƒ</option>';
  } else {
    // ë“œë¡­ë‹¤ìš´ìœ¼ë¡œ ì„ íƒ
    msGrp.classList.remove('hidden');
    schoolIn.classList.add('hidden');
    msSelect.innerHTML = '<option value="" disabled selected>ì¤‘í•™êµ ì„ íƒ</option>';
    schoolMap[v].forEach(sch => {
      const opt = document.createElement('option');
      opt.value = sch;
      opt.text  = sch;
      msSelect.append(opt);
    });
  }
  validate();
}));

    // 5,6ë²ˆ pill ì…‹ì—…
    function setupPills(group) {
      group.forEach(p => p.addEventListener('click', () => {
        group.forEach(x=>x.classList.remove('selected'));
        p.classList.add('selected');
        validate();
      }));
    }
    setupPills([...bPills]);
    setupPills([...tPills]);

    // ì…ë ¥ ì‹œë§ˆë‹¤ ê²€ì¦
    [nameIn, schoolIn, msSelect, genderIn].forEach(el =>
      el.addEventListener('input', validate)
    );
  });
  </script>
</body>
</html>
